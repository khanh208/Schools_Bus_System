INFO 2025-11-15 00:22:58,810 autoreload Watching for file changes with StatReloader
INFO 2025-11-15 00:26:17,325 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\__init__.py changed, reloading.
INFO 2025-11-15 00:26:19,417 autoreload Watching for file changes with StatReloader
ERROR 2025-11-15 00:26:27,199 signal Signal handler <bound method DjangoFixup.on_import_modules of <celery.fixups.django.DjangoFixup object at 0x000002749BD5B0B0>> raised: ImproperlyConfigured('Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.')
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\utils\dispatch\signal.py", line 276, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 97, in on_import_modules
    self.worker_fixup.validate_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 135, in validate_models
    self.django_setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 131, in django_setup
    django.setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\__init__.py", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\registry.py", line 116, in populate
    app_config.import_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\config.py", line 269, in import_models
    self.models_module = import_module(models_module_name)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 3, in <module>
    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\base_user.py", line 57, in <module>
    class AbstractBaseUser(models.Model):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 143, in __new__
    new_class.add_to_class("_meta", Options(meta, app_label))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 371, in add_to_class
    value.contribute_to_class(cls, name)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\options.py", line 243, in contribute_to_class
    self.db_table, connection.ops.max_name_length()
                   ^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 15, in __getattr__
    return getattr(self._connections[self._alias], item)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 62, in __getitem__
    conn = self.create_connection(alias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 193, in create_connection
    backend = load_backend(db["ENGINE"])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 113, in load_backend
    return import_module("%s.base" % backend_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\base.py", line 7, in <module>
    from .adapter import PostGISAdapter
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\adapter.py", line 5, in <module>
    from django.contrib.gis.geos import GEOSGeometry
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\__init__.py", line 5, in <module>
    from .collections import (  # NOQA
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\collections.py", line 6, in <module>
    from django.contrib.gis.geos.geometry import GEOSGeometry, LinearGeometryMixin
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\geometry.py", line 8, in <module>
    from django.contrib.gis import gdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\__init__.py", line 28, in <module>
    from django.contrib.gis.gdal.datasource import DataSource
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\datasource.py", line 40, in <module>
    from django.contrib.gis.gdal.driver import Driver
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\driver.py", line 5, in <module>
    from django.contrib.gis.gdal.prototypes import ds as vcapi
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\prototypes\ds.py", line 9, in <module>
    from django.contrib.gis.gdal.libgdal import lgdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\libgdal.py", line 64, in <module>
    raise ImproperlyConfigured(
django.core.exceptions.ImproperlyConfigured: Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.
ERROR 2025-11-15 00:35:01,374 signal Signal handler <bound method DjangoFixup.on_import_modules of <celery.fixups.django.DjangoFixup object at 0x0000019C82C9A8A0>> raised: ImproperlyConfigured('Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.')
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\utils\dispatch\signal.py", line 276, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 97, in on_import_modules
    self.worker_fixup.validate_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 135, in validate_models
    self.django_setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 131, in django_setup
    django.setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\__init__.py", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\registry.py", line 116, in populate
    app_config.import_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\config.py", line 269, in import_models
    self.models_module = import_module(models_module_name)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 3, in <module>
    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\base_user.py", line 57, in <module>
    class AbstractBaseUser(models.Model):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 143, in __new__
    new_class.add_to_class("_meta", Options(meta, app_label))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 371, in add_to_class
    value.contribute_to_class(cls, name)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\options.py", line 243, in contribute_to_class
    self.db_table, connection.ops.max_name_length()
                   ^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 15, in __getattr__
    return getattr(self._connections[self._alias], item)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 62, in __getitem__
    conn = self.create_connection(alias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 193, in create_connection
    backend = load_backend(db["ENGINE"])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 113, in load_backend
    return import_module("%s.base" % backend_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\base.py", line 7, in <module>
    from .adapter import PostGISAdapter
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\adapter.py", line 5, in <module>
    from django.contrib.gis.geos import GEOSGeometry
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\__init__.py", line 5, in <module>
    from .collections import (  # NOQA
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\collections.py", line 6, in <module>
    from django.contrib.gis.geos.geometry import GEOSGeometry, LinearGeometryMixin
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\geometry.py", line 8, in <module>
    from django.contrib.gis import gdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\__init__.py", line 28, in <module>
    from django.contrib.gis.gdal.datasource import DataSource
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\datasource.py", line 40, in <module>
    from django.contrib.gis.gdal.driver import Driver
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\driver.py", line 5, in <module>
    from django.contrib.gis.gdal.prototypes import ds as vcapi
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\prototypes\ds.py", line 9, in <module>
    from django.contrib.gis.gdal.libgdal import lgdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\libgdal.py", line 64, in <module>
    raise ImproperlyConfigured(
django.core.exceptions.ImproperlyConfigured: Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.
INFO 2025-11-16 22:21:42,137 autoreload Watching for file changes with StatReloader
ERROR 2025-11-16 22:21:59,086 signal Signal handler <bound method DjangoFixup.on_import_modules of <celery.fixups.django.DjangoFixup object at 0x0000028BA3D71D00>> raised: ImproperlyConfigured('Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.')
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\utils\dispatch\signal.py", line 276, in send
    response = receiver(signal=self, sender=sender, **named)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 97, in on_import_modules
    self.worker_fixup.validate_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 135, in validate_models
    self.django_setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\celery\fixups\django.py", line 131, in django_setup
    django.setup()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\__init__.py", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\registry.py", line 116, in populate
    app_config.import_models()
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\apps\config.py", line 269, in import_models
    self.models_module = import_module(models_module_name)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 3, in <module>
    from django.contrib.auth.base_user import AbstractBaseUser, BaseUserManager
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\base_user.py", line 57, in <module>
    class AbstractBaseUser(models.Model):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 143, in __new__
    new_class.add_to_class("_meta", Options(meta, app_label))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\base.py", line 371, in add_to_class
    value.contribute_to_class(cls, name)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\options.py", line 243, in contribute_to_class
    self.db_table, connection.ops.max_name_length()
                   ^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 15, in __getattr__
    return getattr(self._connections[self._alias], item)
                   ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\connection.py", line 62, in __getitem__
    conn = self.create_connection(alias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 193, in create_connection
    backend = load_backend(db["ENGINE"])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\utils.py", line 113, in load_backend
    return import_module("%s.base" % backend_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\base.py", line 7, in <module>
    from .adapter import PostGISAdapter
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\db\backends\postgis\adapter.py", line 5, in <module>
    from django.contrib.gis.geos import GEOSGeometry
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\__init__.py", line 5, in <module>
    from .collections import (  # NOQA
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\collections.py", line 6, in <module>
    from django.contrib.gis.geos.geometry import GEOSGeometry, LinearGeometryMixin
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\geos\geometry.py", line 8, in <module>
    from django.contrib.gis import gdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\__init__.py", line 28, in <module>
    from django.contrib.gis.gdal.datasource import DataSource
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\datasource.py", line 40, in <module>
    from django.contrib.gis.gdal.driver import Driver
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\driver.py", line 5, in <module>
    from django.contrib.gis.gdal.prototypes import ds as vcapi
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\prototypes\ds.py", line 9, in <module>
    from django.contrib.gis.gdal.libgdal import lgdal
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\gis\gdal\libgdal.py", line 64, in <module>
    raise ImproperlyConfigured(
django.core.exceptions.ImproperlyConfigured: Could not find the GDAL library (tried "gdal306", "gdal305", "gdal304", "gdal303", "gdal302", "gdal301", "gdal300", "gdal204", "gdal203", "gdal202"). Is GDAL installed? If it is, try setting GDAL_LIBRARY_PATH in your settings.
INFO 2025-11-16 22:27:12,492 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 22:27:14,786 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 22:27:38,884 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 23:27:34,036 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:27:34,426 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-16 23:27:34,431 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-16 23:27:34,432 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-16 23:27:38,924 log Internal Server Error: /api/auth/login/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-16 23:27:39,461 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-16 23:27:39,461 runserver [35;1mHTTP POST /api/auth/login/ 500 [0.90, 127.0.0.1:51580][0m
ERROR 2025-11-16 23:29:08,863 log Internal Server Error: /api/auth/register/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-16 23:29:09,130 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-16 23:29:09,130 runserver [35;1mHTTP POST /api/auth/register/ 500 [0.29, 127.0.0.1:61266][0m
ERROR 2025-11-16 23:29:19,570 log Internal Server Error: /api/auth/login/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-16 23:29:20,201 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-16 23:29:20,202 runserver [35;1mHTTP POST /api/auth/login/ 500 [0.65, 127.0.0.1:61266][0m
INFO 2025-11-16 23:31:45,492 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:31:45,834 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-16 23:31:45,834 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-16 23:31:45,836 server Listening on TCP address 127.0.0.1:8000
INFO 2025-11-16 23:32:34,046 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 23:32:36,224 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:32:58,505 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 23:33:00,871 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:33:19,464 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 23:33:21,893 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:33:38,092 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-16 23:33:40,186 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:33:40,630 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-16 23:33:40,630 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-16 23:33:40,632 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-16 23:34:10,166 log Internal Server Error: /api/auth/login/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-16 23:34:10,812 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-16 23:34:10,813 runserver [35;1mHTTP POST /api/auth/login/ 500 [0.68, 127.0.0.1:59673][0m
INFO 2025-11-16 23:34:34,689 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:34:35,146 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-16 23:34:35,146 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-16 23:34:35,153 server Listening on TCP address 127.0.0.1:8000
INFO 2025-11-16 23:35:13,563 autoreload Watching for file changes with StatReloader
INFO 2025-11-16 23:35:13,912 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-16 23:35:13,912 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-16 23:35:13,913 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-16 23:35:19,317 log Internal Server Error: /api/auth/login/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-16 23:35:19,947 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-16 23:35:19,949 runserver [35;1mHTTP POST /api/auth/login/ 500 [0.68, 127.0.0.1:53536][0m
INFO 2025-11-17 14:05:53,241 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 14:05:53,832 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-17 14:05:53,832 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-17 14:05:53,835 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-17 14:06:04,961 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-17 14:06:04,964 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-17 14:06:04,968 runserver [35;1mHTTP GET /admin/ 500 [0.50, 127.0.0.1:51128][0m
ERROR 2025-11-17 14:06:05,702 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-17 14:06:05,977 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-17 14:06:05,978 runserver [35;1mHTTP GET /favicon.ico 500 [0.31, 127.0.0.1:51128][0m
INFO 2025-11-17 14:19:15,476 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 14:19:15,814 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-17 14:19:15,814 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-17 14:19:15,826 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-17 14:19:25,487 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-17 14:19:25,892 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-17 14:19:25,895 runserver [35;1mHTTP GET /admin/ 500 [0.52, 127.0.0.1:55461][0m
ERROR 2025-11-17 14:19:26,017 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-17 14:19:26,901 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-17 14:19:26,903 runserver [35;1mHTTP GET /favicon.ico 500 [0.91, 127.0.0.1:55461][0m
INFO 2025-11-17 14:20:34,688 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-17 14:20:36,293 autoreload Watching for file changes with StatReloader
WARNING 2025-11-17 14:20:39,156 log Not Found: /
WARNING 2025-11-17 14:20:39,556 log Not Found: /favicon.ico
WARNING 2025-11-17 14:21:39,267 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,409 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,414 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,414 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,414 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,419 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,421 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,421 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,429 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,430 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,430 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,430 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,436 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,440 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,440 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,440 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,444 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,448 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,448 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,448 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,448 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,460 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,464 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,464 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,468 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,477 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,479 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,483 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,484 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,485 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,486 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,488 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,489 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,490 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,492 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,494 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,495 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,497 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,497 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,497 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,497 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,497 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,510 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,512 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,514 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,515 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,515 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,515 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,515 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,515 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,527 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,531 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,536 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,540 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,545 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,551 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,555 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,557 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,563 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,565 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,572 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:21:39,577 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:39,585 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x000001CABA12DE80>.
WARNING 2025-11-17 14:21:51,130 log Method Not Allowed: /api/auth/login/
WARNING 2025-11-17 14:21:51,267 log Not Found: /favicon.ico
INFO 2025-11-17 14:35:58,953 autoreload Watching for file changes with StatReloader
WARNING 2025-11-17 14:36:07,847 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,855 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,857 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,857 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,857 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,857 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,861 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,863 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,869 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,880 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,882 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,882 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,882 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,882 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,882 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,897 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,898 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,898 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,913 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,917 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,918 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,918 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,922 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,922 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,922 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,922 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,931 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,931 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,934 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,934 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,938 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,938 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,940 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,940 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,947 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,947 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,950 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,951 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,963 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,963 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,963 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,963 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,963 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,963 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,978 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,980 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,980 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,980 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,987 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 14:36:07,989 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
WARNING 2025-11-17 14:36:07,993 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000020144373320>.
INFO 2025-11-17 15:16:15,596 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\urls.py changed, reloading.
INFO 2025-11-17 15:16:20,198 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:17:58,468 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\urls.py changed, reloading.
INFO 2025-11-17 15:18:00,105 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:19:53,495 autoreload Watching for file changes with StatReloader
WARNING 2025-11-17 15:20:30,143 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,284 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,284 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,284 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,284 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,284 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,294 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,297 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,302 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,305 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,316 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,318 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,319 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,319 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,319 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,319 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,333 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,339 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,339 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,349 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,351 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,352 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,355 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,358 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,359 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,361 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,362 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,363 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,364 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,366 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,367 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,370 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,370 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,370 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,370 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,379 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,383 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,385 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,387 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,406 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,416 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,428 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,432 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,440 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,450 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,454 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,461 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,465 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,470 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,475 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,479 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:30,486 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:30,493 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000149630B6E10>.
WARNING 2025-11-17 15:20:39,773 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,775 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,775 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,775 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,779 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,779 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,781 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,781 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,783 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,783 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,783 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,783 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,783 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,790 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,791 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,793 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,793 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,793 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,793 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,793 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,793 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,793 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,793 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,827 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,829 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,832 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,833 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,838 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,838 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,840 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,841 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,841 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,844 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,844 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,858 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,863 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,863 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,863 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,868 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,868 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,868 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,872 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,873 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,875 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,877 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,879 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,879 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,884 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,884 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,888 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,890 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,892 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,892 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,892 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,892 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,899 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,899 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,899 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-17 15:20:39,899 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:20:39,899 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000014963289670>.
WARNING 2025-11-17 15:21:14,538 log Not Found: /home
INFO 2025-11-17 15:23:41,501 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-17 15:23:43,194 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:23:51,525 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-17 15:23:53,567 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:24:10,652 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-17 15:24:12,207 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:24:26,327 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-17 15:24:28,320 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:25:32,482 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\models.py changed, reloading.
INFO 2025-11-17 15:25:34,194 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:26:39,302 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:26:40,989 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:26:47,932 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:26:49,388 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:28:08,021 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:28:09,725 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:28:42,008 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:28:44,115 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:29:03,351 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:29:04,966 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:29:24,096 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:29:25,602 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:29:43,657 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:29:45,459 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:30:05,905 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:30:07,529 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:32:06,154 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\models.py changed, reloading.
INFO 2025-11-17 15:32:07,833 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:33:00,195 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\models.py changed, reloading.
INFO 2025-11-17 15:33:01,843 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:33:21,930 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\models.py changed, reloading.
INFO 2025-11-17 15:33:23,589 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:33:42,859 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\models.py changed, reloading.
INFO 2025-11-17 15:33:44,517 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:34:57,059 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\models.py changed, reloading.
INFO 2025-11-17 15:34:59,086 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:35:36,537 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\admin.py changed, reloading.
INFO 2025-11-17 15:35:38,781 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:35:52,581 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\admin.py changed, reloading.
INFO 2025-11-17 15:35:54,399 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:37:02,708 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\admin.py changed, reloading.
INFO 2025-11-17 15:37:04,332 autoreload Watching for file changes with StatReloader
INFO 2025-11-17 15:37:44,452 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\admin.py changed, reloading.
INFO 2025-11-17 15:37:46,045 autoreload Watching for file changes with StatReloader
INFO 2025-11-18 21:13:38,099 autoreload Watching for file changes with StatReloader
INFO 2025-11-18 21:16:26,514 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 20:56:52,069 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 21:06:46,643 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 21:21:44,166 cli Starting server at tcp:port=8000:interface=0.0.0.0
INFO 2025-11-19 21:21:44,168 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 21:21:44,169 server Configuring endpoint tcp:port=8000:interface=0.0.0.0
INFO 2025-11-19 21:21:44,172 server Listening on TCP address 0.0.0.0:8000
INFO 2025-11-19 21:27:28,702 cli Starting server at tcp:port=8000:interface=0.0.0.0
INFO 2025-11-19 21:27:28,702 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 21:27:28,702 server Configuring endpoint tcp:port=8000:interface=0.0.0.0
INFO 2025-11-19 21:27:28,704 server Listening on TCP address 0.0.0.0:8000
INFO 2025-11-19 21:28:15,514 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 21:30:48,875 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 21:30:49,610 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 21:30:49,610 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 21:30:49,610 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-19 21:31:45,925 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 21:31:45,925 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 21:31:45,941 runserver [35;1mHTTP GET / 500 [1.24, 127.0.0.1:54639][0m
ERROR 2025-11-19 21:31:46,179 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 21:31:46,947 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 21:31:46,948 runserver [35;1mHTTP GET /favicon.ico 500 [0.83, 127.0.0.1:54639][0m
INFO 2025-11-19 22:25:55,891 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 22:25:56,471 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 22:25:56,471 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:25:56,471 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-19 22:26:46,340 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:26:46,860 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:26:46,861 runserver [35;1mHTTP GET / 500 [0.66, 127.0.0.1:53895][0m
ERROR 2025-11-19 22:26:47,004 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:26:47,863 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:26:47,868 runserver [35;1mHTTP GET /favicon.ico 500 [0.89, 127.0.0.1:53895][0m
INFO 2025-11-19 22:32:39,092 cli Starting server at tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:32:39,092 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 22:32:39,092 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:32:39,094 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-19 22:32:47,658 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:32:48,156 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:32:48,302 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:32:49,170 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
INFO 2025-11-19 22:33:35,561 server Killed 0 pending application instances
ERROR 2025-11-19 22:36:18,043 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:36:18,049 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:36:18,253 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:36:19,055 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
INFO 2025-11-19 22:36:43,437 autoreload Watching for file changes with StatReloader
INFO 2025-11-19 22:36:43,904 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 22:36:43,904 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:36:43,905 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-19 22:36:47,350 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:36:47,350 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:36:47,531 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:36:48,364 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
INFO 2025-11-19 22:37:01,578 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-19 22:37:03,635 autoreload Watching for file changes with StatReloader
ERROR 2025-11-19 22:37:05,626 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:06,505 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:37:06,695 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:07,512 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:37:08,165 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:08,528 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:37:08,586 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:09,544 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:37:09,957 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:10,560 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-19 22:37:10,680 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-19 22:37:11,576 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
WARNING 2025-11-19 22:37:22,622 log Not Found: /favicon.ico
WARNING 2025-11-19 22:37:28,414 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,679 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,679 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,679 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,679 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,679 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,679 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,695 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,697 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,700 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,701 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,704 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,706 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,709 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,711 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,727 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,727 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,727 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,727 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,727 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,744 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,745 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,749 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,750 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,750 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,755 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,756 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,758 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,762 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,762 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,762 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,768 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,769 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,769 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,769 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,769 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,774 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,777 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,777 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,782 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,782 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,782 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,793 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,794 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,796 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,799 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,801 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,801 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,807 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,807 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,810 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,812 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,814 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,814 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,816 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,816 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,816 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:28,816 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:28,816 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4C24A40>.
WARNING 2025-11-19 22:37:35,520 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,520 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,520 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,520 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,520 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,520 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,520 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,535 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,537 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,539 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,540 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,541 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,542 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,543 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,544 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,545 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,546 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,547 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,548 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,550 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,553 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,556 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,556 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,556 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,571 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,575 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,577 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,577 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,587 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,587 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,587 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,604 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,607 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,622 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,622 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,630 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,630 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,630 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,630 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,630 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,639 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,640 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,642 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,642 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,642 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-19 22:37:35,642 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
WARNING 2025-11-19 22:37:35,642 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x0000022FD4A2C5F0>.
INFO 2025-11-19 22:42:54,771 cli Starting server at tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:42:54,771 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-19 22:42:54,771 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-19 22:42:54,771 server Listening on TCP address 127.0.0.1:8000
INFO 2025-11-19 22:43:00,811 server Killed 0 pending application instances
INFO 2025-11-20 04:19:15,270 autoreload Watching for file changes with StatReloader
INFO 2025-11-20 04:19:27,410 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-20 04:19:30,834 autoreload Watching for file changes with StatReloader
INFO 2025-11-20 04:19:31,325 server HTTP/2 support not enabled (install the http2 and tls Twisted extras)
INFO 2025-11-20 04:19:31,327 server Configuring endpoint tcp:port=8000:interface=127.0.0.1
INFO 2025-11-20 04:19:31,328 server Listening on TCP address 127.0.0.1:8000
ERROR 2025-11-20 04:19:33,959 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 04:19:34,350 server Exception inside application: object HttpResponse can't be used in 'await' expression
Traceback (most recent call last):
  File "E:\Anaconda3\Lib\site-packages\django\contrib\staticfiles\handlers.py", line 101, in __call__
    return await self.application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\channels\routing.py", line 62, in __call__
    return await application(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 160, in __call__
    await self.handle(scope, receive, send)
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\asgi.py", line 183, in handle
    response = await self.get_response_async(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Anaconda3\Lib\site-packages\django\core\handlers\base.py", line 162, in get_response_async
    response = await self._middleware_chain(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object HttpResponse can't be used in 'await' expression
ERROR 2025-11-20 04:19:34,358 runserver [35;1mHTTP GET / 500 [0.48, 127.0.0.1:53626][0m
INFO 2025-11-20 04:19:52,069 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\settings.py changed, reloading.
INFO 2025-11-20 04:19:54,526 autoreload Watching for file changes with StatReloader
ERROR 2025-11-20 14:02:20,708 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:02:20,844 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:03:17,875 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:03:17,943 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:04:03,733 log Internal Server Error: /swagger/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:04:04,085 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:04:09,250 log Internal Server Error: /api/tracking/parent/demo/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:04:09,387 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:05:11,278 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:05:11,410 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:05:15,304 log Internal Server Error: /api/tracking/parent/demo/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:05:15,656 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:06:06,569 log Internal Server Error: /.well-known/appspecific/com.chrome.devtools.json
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:07:02,245 log Internal Server Error: /api/tracking/trips/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:07:02,619 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:07:02,718 log Internal Server Error: /.well-known/appspecific/com.chrome.devtools.json
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:20,006 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:20,182 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:22,663 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:22,966 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:25,258 log Internal Server Error: /.well-known/appspecific/com.chrome.devtools.json
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:45,750 log Internal Server Error: /api/tracking/parent/demo/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:12:46,102 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:14:01,144 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:14:01,286 log Internal Server Error: /favicon.ico
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
INFO 2025-11-20 14:16:05,302 autoreload Watching for file changes with StatReloader
WARNING 2025-11-20 14:16:08,725 log Not Found: /favicon.ico
ERROR 2025-11-20 14:16:10,998 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\backends\django.py", line 61, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 175, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 321, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'dashboard' not found. 'dashboard' is not a valid view function or pattern name.
WARNING 2025-11-20 14:18:08,122 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,269 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,270 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,270 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,270 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,270 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,276 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,276 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,276 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,280 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,280 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,285 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,287 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,289 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,305 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,308 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,308 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,308 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,308 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,308 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,308 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,318 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,320 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,322 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,323 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,324 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,326 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,326 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,326 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,331 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,331 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,331 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,334 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,336 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,337 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,337 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,337 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,337 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,337 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,337 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,337 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,352 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,354 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,355 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,358 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,370 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,373 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,373 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,373 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,373 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,373 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,381 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,381 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,381 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,385 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,387 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:08,389 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:08,393 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C4FE7E30>.
WARNING 2025-11-20 14:18:15,079 log Not Found: /accounts/login/
WARNING 2025-11-20 14:18:19,329 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,330 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,330 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,338 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,338 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,340 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,342 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,343 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,343 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,360 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,361 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,361 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,361 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,361 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,361 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,361 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,372 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,372 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,375 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,377 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,377 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,388 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,388 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,392 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,393 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,395 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,397 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,399 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,401 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,401 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,401 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,401 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,407 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,409 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,412 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,412 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,413 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,413 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,413 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,425 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:19,426 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
WARNING 2025-11-20 14:18:19,426 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C5316780>.
ERROR 2025-11-20 14:18:23,571 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\backends\django.py", line 61, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 175, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 321, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'dashboard' not found. 'dashboard' is not a valid view function or pattern name.
WARNING 2025-11-20 14:18:58,039 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,042 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,042 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,053 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,055 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,056 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,059 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,060 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,061 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,061 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,064 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,064 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,072 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,075 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,077 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,077 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,079 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,081 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,081 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,081 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,085 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,089 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,095 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,101 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,110 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,116 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,120 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,127 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,134 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,140 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,145 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,152 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,159 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,163 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,170 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,174 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,177 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,178 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,180 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,181 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,183 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,186 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,192 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,197 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,199 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,199 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,202 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,207 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,210 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,213 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,214 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,216 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,216 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,216 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,216 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,216 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,222 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,223 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:18:58,224 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:18:58,228 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C53168A0>.
WARNING 2025-11-20 14:19:04,573 log Not Found: /swagger/api/notifications/notifications/
WARNING 2025-11-20 14:19:19,807 log Not Found: /favicon.ico
WARNING 2025-11-20 14:19:41,753 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,756 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,757 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,758 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,759 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,759 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,761 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,761 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,762 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,763 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,765 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,766 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,767 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,769 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,769 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,771 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,771 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,772 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,773 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,774 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,775 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,777 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,779 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,780 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,782 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,784 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,785 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,785 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,786 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,787 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,788 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,789 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,790 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,791 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,793 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,793 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,793 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,794 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,795 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,796 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,797 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,799 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,801 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,803 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,804 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,806 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,807 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,808 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,809 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,809 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,810 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,811 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,811 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,812 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,812 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,815 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,817 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,819 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,820 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,821 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,821 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,821 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,821 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,821 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,825 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,825 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,826 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:19:41,826 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:41,829 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000116C501AD80>.
WARNING 2025-11-20 14:19:44,998 log Unauthorized: /api/tracking/trips/
WARNING 2025-11-20 14:19:49,734 log Not Found: /ws/notifications/
WARNING 2025-11-20 14:19:59,934 log Unauthorized: /api/tracking/trips/
ERROR 2025-11-20 14:20:46,522 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\backends\django.py", line 61, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 175, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 321, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'dashboard' not found. 'dashboard' is not a valid view function or pattern name.
ERROR 2025-11-20 14:21:02,355 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\backends\django.py", line 61, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 175, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 321, in render
    return nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\urls\resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'dashboard' not found. 'dashboard' is not a valid view function or pattern name.
INFO 2025-11-20 14:23:20,192 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\urls.py changed, reloading.
INFO 2025-11-20 14:23:22,330 autoreload Watching for file changes with StatReloader
INFO 2025-11-20 14:23:29,760 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\config\urls.py changed, reloading.
INFO 2025-11-20 14:23:31,631 autoreload Watching for file changes with StatReloader
INFO 2025-11-20 14:23:47,056 autoreload Watching for file changes with StatReloader
ERROR 2025-11-20 14:23:58,410 log Internal Server Error: /swagger/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:24:38,806 log Internal Server Error: /swagger/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
ERROR 2025-11-20 14:24:43,418 log Internal Server Error: /
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
INFO 2025-11-20 14:24:47,838 autoreload Watching for file changes with StatReloader
ERROR 2025-11-20 14:24:59,955 log Internal Server Error: /admin/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
WARNING 2025-11-20 14:37:28,154 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,154 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,164 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's AttendanceReportViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 224, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,173 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,181 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,181 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,184 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,188 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,188 base view's SessionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\authentication\views.py", line 404, in get_queryset
    return UserSession.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,188 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,188 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,198 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,199 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,200 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,201 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,201 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,204 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,204 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,204 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,204 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,204 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,204 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,213 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,215 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,216 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,216 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,232 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,233 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,235 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,247 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,250 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,250 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,255 base view's StudentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 152, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's StudentNoteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 317, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's StudentDocumentViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 344, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's EmergencyContactViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\students\views.py", line 369, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's RouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 104, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's StudentRouteViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\routes\views.py", line 271, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,255 base view's AttendanceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 39, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,264 base view's AttendanceExceptionViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 177, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,266 base view's AttendanceAlertViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\attendance\views.py", line 277, in get_queryset
    if user.role == 'parent' and hasattr(user, 'parent_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,268 base view's TripViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\views.py", line 53, in get_queryset
    if user.role == 'driver' and hasattr(user, 'driver_profile'):
       ^^^^^^^^^
AttributeError: 'AnonymousUser' object has no attribute 'role'
WARNING 2025-11-20 14:37:28,269 base view's NotificationViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 32, in get_queryset
    return Notification.objects.filter(user=self.request.user).order_by('-created_at')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
WARNING 2025-11-20 14:37:28,272 base view's NotificationPreferenceViewSet raised exception during schema generation; use `getattr(self, 'swagger_fake_view', False)` to detect and short-circuit this
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2053, in get_prep_value
    return int(value)
           ^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\auth\models.py", line 437, in __int__
    raise TypeError(
TypeError: Cannot cast AnonymousUser to int. Are you trying to use it in place of User?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\drf_yasg\inspectors\base.py", line 42, in call_view_method
    return view_method()
           ^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\notifications\views.py", line 79, in get_queryset
    return NotificationPreference.objects.filter(user=self.request.user)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1436, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1454, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\query.py", line 1461, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1545, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1576, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1491, in build_filter
    condition = self.build_lookup(lookups, col, value)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\sql\query.py", line 1318, in build_lookup
    lookup = lookup_class(lhs, rhs)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\lookups.py", line 27, in __init__
    self.rhs = self.get_prep_lookup()
               ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\related_lookups.py", line 166, in get_prep_lookup
    self.rhs = target_field.get_prep_value(self.rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\fields\__init__.py", line 2055, in get_prep_value
    raise e.__class__(
TypeError: Field 'id' expected a number but got <django.contrib.auth.models.AnonymousUser object at 0x00000177C64A2990>.
ERROR 2025-11-20 14:38:46,711 log Internal Server Error: /admin/tracking/trip/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\options.py", line 681, in get_field
    return self.fields_map[field_name]
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'get_attendance'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\utils.py", line 272, in lookup_field
    f = _get_non_gfk_field(opts, name)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\utils.py", line 303, in _get_non_gfk_field
    field = opts.get_field(name)
            ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\db\models\options.py", line 683, in get_field
    raise FieldDoesNotExist(
django.core.exceptions.FieldDoesNotExist: Trip has no field named 'get_attendance'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\base.py", line 220, in _get_response
    response = response.render()
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 114, in render
    self.content = self.rendered_content
                   ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\response.py", line 92, in rendered_content
    return template.render(context, self._request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\backends\django.py", line 61, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 175, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 157, in render
    return compiled_parent._render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\test\utils.py", line 112, in instrumented_test_render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\loader_tags.py", line 63, in render
    result = block.nodelist.render(context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\base.py", line 966, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\templatetags\base.py", line 45, in render
    return super().render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\template\library.py", line 258, in render
    _dict = self.func(*resolved_args, **resolved_kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\templatetags\admin_list.py", line 336, in result_list
    "results": list(results(cl)),
               ^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\templatetags\admin_list.py", line 312, in results
    yield ResultList(None, items_for_result(cl, res, None))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\templatetags\admin_list.py", line 303, in __init__
    super().__init__(*items)
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\templatetags\admin_list.py", line 213, in items_for_result
    f, attr, value = lookup_field(field_name, result, cl.model_admin)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\contrib\admin\utils.py", line 281, in lookup_field
    value = attr(obj)
            ^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\admin.py", line 73, in get_attendance
    return format_html(
           ^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\html.py", line 105, in format_html
    return mark_safe(format_string.format(*args_safe, **kwargs_safe))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Unknown format code 'f' for object of type 'SafeString'
WARNING 2025-11-20 14:41:01,501 log Unauthorized: /api/tracking/trips/
WARNING 2025-11-20 14:41:14,036 log Unauthorized: /api/tracking/trips/
INFO 2025-11-20 15:32:26,066 autoreload E:\NguyenQuocKhanh\DAMH\school_bus_system\apps\tracking\models.py changed, reloading.
INFO 2025-11-20 15:32:30,925 autoreload Watching for file changes with StatReloader
ERROR 2025-11-20 22:32:28,759 log Internal Server Error: /admin/routes/vehiclemaintenance/
Traceback (most recent call last):
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\utils\deprecation.py", line 136, in __call__
    response = self.process_response(request, response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\NguyenQuocKhanh\DAMH\school_bus_system\venv\Lib\site-packages\django\middleware\security.py", line 47, in process_response
    response.headers.setdefault("X-Content-Type-Options", "nosniff")
    ^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'headers'
